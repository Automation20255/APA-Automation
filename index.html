<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APA 7 Reference Studio</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* ==========================
   Root Variables
========================== */
:root {
  --bg: #f4f6fb;
  --card-bg: #fff;
  --primary: #4f46e5;
  --secondary: #1f2937;
  --muted: #6b7280;
  --success: #10b981;
  --danger: #ef4444;
  --border: #e5e7eb;
  --radius: 12px;
  --shadow: 0 12px 28px rgba(0, 0, 0, 0.08);
}

/* ==========================
   Global Styles
========================== */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Inter', sans-serif;
  background: var(--bg);
  color: var(--secondary);
  line-height: 1.6;
}

h1, h2, h3, h4 {
  margin: 0;
}

h1 { font-size: 1.6rem; font-weight: 700; font-family: Anek Gujarati; }
h2 { font-size: 1.2rem; font-weight: 600; }
h4 { font-weight: 500; font-family: Anek Gujarati; }

/* ==========================
   Layout
========================== */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 24px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
}

@media (max-width: 1024px) {
  .container {
    grid-template-columns: 1fr;
  }
}

/* ==========================
   Cards
========================== */
.card {
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  transition: transform 0.2s;
}

.card:hover {
  transform: translateY(-2px);
}

/* ==========================
   Forms
========================== */
.form-group {
  margin-bottom: 16px;
}

label {
  display: block;
  font-weight: 600;
  margin-bottom: 6px;
  font-size: 0.875rem;
  color: var(--muted);
}

input, select, textarea {
  width: 100%;
  padding: 10px 12px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  font-size: 0.95rem;
  transition: border 0.2s;
}

input:focus,
select:focus,
textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
}

textarea {
  resize: vertical;
  min-height: 80px;
}

.hint {
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 4px;
}

/* ==========================
   Buttons
========================== */
.btn {
  padding: 10px 16px;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  transition: 0.2s;
}

.btn-primary {
  background: var(--primary);
  color: #fff;
}

.btn-primary:hover {
  background: #4338ca;
}

.btn-secondary {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--secondary);
}

.btn-secondary:hover {
  background: var(--bg);
}

/* ==========================
   References / APA List
========================== */
.refs {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-height: 500px;
  overflow-y: auto;
  font-size: 0.9rem;
}

.ref-item {
  background: #f9fafb;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  padding: 12px;
  display: flex;
  justify-content: space-between;
  align-items: start;
}

.ref-actions button {
  font-size: 0.8rem;
}

.apa-list {
  padding-left: 20px;
  margin: 0;
  font-size: 0.9rem;
}

.apa-list li {
  margin-bottom: 12px;
  text-indent: -1.25em;
  padding-left: 1.25em;
}

/* ==========================
   Typography Helpers
========================== */
.section-title {
  font-weight: 600;
  margin-bottom: 8px;
  font-size: 1rem;
  color: var(--secondary);
}

.preview-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.muted {
  color: var(--muted);
  font-size: 0.875rem;
}

</style>
</head>
<body>
<div class="container">
<!-- Left Panel: Input Form -->
<div class="card">
<h1>Visionary APA 7 Reference Studio</h1>
<h4>Developed by Dr. Dhaval Patel</h4>
<p class="muted">Enter bibliographic details. Preview & add references to the list.</p>


<div class="form-group">
<label>Reference Type</label>
<select id="type">
<option value="journal">Journal Article</option>
<option value="book">Book</option>
<option value="chapter">Book Chapter</option>
<option value="website">Website</option>
</select>
</div>

<div class="form-group">
<label>Author(s)</label>
<input id="authors" placeholder="e.g. Manoj Panchal; Priya K Patel">
<div class="hint">Multiple authors separated by semicolons.</div>
</div>

<div class="form-group">
<label>Year</label>
<input id="year" placeholder="2025">
</div>

<div class="form-group">
<label>Title</label>
<input id="title" placeholder="Title of article / book / page">
</div>

<!-- Journal Fields -->
<div class="journalFields form-group">
<label>Journal Name</label>
<input id="journal" placeholder="Visionary Vault">
<label>Volume</label>
<input id="volume" placeholder="2">
<label>Issue (optional)</label>
<input id="issue" placeholder="2">
<label>Pages (e.g., 34–44)</label>
<input id="pages" placeholder="34–44">
<label>DOI (optional)</label>
<input id="doi" placeholder="10.xxxx/xxxx">
<label>URL (optional)</label>
<input id="url" placeholder="https://www.example.com">
</div>

<!-- Book Fields -->
<div class="bookFields form-group" style="display:none">
<label>Publisher</label>
<input id="publisher" placeholder="Publisher name">
<label>Edition (optional)</label>
<input id="edition" placeholder="2nd ed.">
<label>DOI (optional)</label>
<input id="bookdoi" placeholder="10.xxxx/xxxx">
<label>URL (optional)</label>
<input id="bookurl" placeholder="https://www.example.com">
</div>

<!-- Chapter Fields -->
<div class="chapterFields form-group" style="display:none">
<label>Book Title</label>
<input id="bookTitle" placeholder="Title of book">
<label>Editors</label>
<input id="editors" placeholder="A. Editor; B. Editor">
<label>Pages (pp. xx–yy)</label>
<input id="chpages" placeholder="pp. 12–34">
<label>Publisher</label>
<input id="chpublisher" placeholder="Publisher">
<label>DOI (optional)</label>
<input id="chdoi" placeholder="10.xxxx/xxxx">
<label>URL (optional)</label>
<input id="churl" placeholder="https://www.example.com">
</div>

<!-- Website Fields -->
<div class="websiteFields form-group" style="display:none">
<label>Website / Organization</label>
<input id="siteName" placeholder="Organization or Site name">
<label>URL</label>
<input id="siteUrl" placeholder="https://www.example.com">
<label>Access Date (optional)</label>
<input id="accessDate" placeholder="e.g. November 28, 2025">
</div>

<div style="display:flex; gap:12px; margin-top:16px;">
<button class="btn btn-primary" id="addRef">Add to List</button>
<button class="btn btn-secondary" id="previewRef">Preview</button>
<button class="btn btn-secondary" id="clearFields">Clear Fields</button>
</div>

<div class="form-group" style="margin-top:16px">
<div class="section-title">Preview</div>
<div id="singlePreview" class="muted">No preview yet.</div>
</div>
</div>

<!-- Right Panel: References List -->
<div class="card">
<div class="preview-head">
<div>
<h2>Reference List</h2>
<div class="muted">Collected references (APA 7)</div>
</div>
<div style="display:flex; gap:8px">
<button class="btn btn-secondary" id="copyAll">Copy All</button>
<button class="btn btn-secondary" id="downloadHtml">Download</button>
</div>
</div>

<div id="refsContainer" class="refs">
<div class="muted">No references yet.</div>
</div>

<div class="form-group" style="margin-top:16px">
<div class="section-title">Final Output (APA 7)</div>
<ol id="apaOutput" class="apa-list"></ol>
</div>
</div>
</div>

<script>
const typeEl=document.getElementById('type');
const refsContainer=document.getElementById('refsContainer');
let refs=[];

function toggleFields(){
document.querySelectorAll('.journalFields,.bookFields,.chapterFields,.websiteFields').forEach(f=>f.style.display='none');
if(typeEl.value==='journal') document.querySelector('.journalFields').style.display='';
else if(typeEl.value==='book') document.querySelector('.bookFields').style.display='';
else if(typeEl.value==='chapter') document.querySelector('.chapterFields').style.display='';
else if(typeEl.value==='website') document.querySelector('.websiteFields').style.display='';
document.getElementById('singlePreview').textContent='No preview yet.';
}
typeEl.addEventListener('change', toggleFields);
toggleFields();

function formatAuthors(raw){
if(!raw) return '';
const parts=raw.split(';').map(s=>s.trim()).filter(Boolean);
const formatted=parts.map(name=>{
if(name.includes(',')) return name;
const tokens=name.split(/\s+/);
const last=tokens.pop();
const initials=tokens.map(t=>t[0]?.toUpperCase()+'.').join(' ');
return `${last}, ${initials}`;
});
if(formatted.length===1) return formatted[0];
if(formatted.length===2) return formatted.join(' & ');
return formatted.slice(0,-1).join(', ') + ', & ' + formatted.slice(-1);
}

function gatherInputs(){
const base={ type:typeEl.value, authors:document.getElementById('authors').value, year:document.getElementById('year').value, title:document.getElementById('title').value };
if(base.type==='journal'){
base.journal=document.getElementById('journal').value;
base.volume=document.getElementById('volume').value;
base.issue=document.getElementById('issue').value;
base.pages=document.getElementById('pages').value;
base.doi=document.getElementById('doi').value;
base.url=document.getElementById('url').value;
} else if(base.type==='book'){
base.publisher=document.getElementById('publisher').value;
base.edition=document.getElementById('edition').value;
base.doi=document.getElementById('bookdoi').value;
base.url=document.getElementById('bookurl').value;
} else if(base.type==='chapter'){
base.bookTitle=document.getElementById('bookTitle').value;
base.editors=document.getElementById('editors').value;
base.chpages=document.getElementById('chpages').value;
base.chpublisher=document.getElementById('chpublisher').value;
base.doi=document.getElementById('chdoi').value;
base.url=document.getElementById('churl').value;
} else if(base.type==='website'){
base.siteName=document.getElementById('siteName').value;
base.url=document.getElementById('siteUrl').value;
base.accessDate=document.getElementById('accessDate').value;
}
return base;
}

function fixDOI(raw){if(!raw) return ''; return raw.trim().startsWith('http')?raw:'https://doi.org/'+raw.trim();}
function fixURL(raw){return raw?raw.trim():'';}

function generateAPA(values){
const authors=formatAuthors(values.authors);
const year=values.year||'n.d.';
const title=values.title||'';
if(values.type==='journal'){
const volIssue=values.volume?values.volume+(values.issue?`(${values.issue})`:''):'';
const doi=fixDOI(values.doi); const url=fixURL(values.url);
return `${authors} (${year}). ${title}. ${values.journal}, ${volIssue}, ${values.pages}.${doi?(' ' + doi):''}${url?(' ' + url):''}`;
}
if(values.type==='book'){
const ed=values.edition?` (${values.edition})`:''; const doi=fixDOI(values.doi); const url=fixURL(values.url);
return `${authors} (${year}). ${title}${ed}. ${values.publisher}.${doi?(' ' + doi):''}${url?(' ' + url):''}`;
}
if(values.type==='chapter'){
const editors=values.editors?`In ${formatAuthors(values.editors)} (Eds.), `:''; const pages=values.chpages?`${values.chpages}. `:'';
const doi=fixDOI(values.doi); const url=fixURL(values.url);
return `${authors} (${year}). ${title}. ${editors}${values.bookTitle}, ${pages}${values.chpublisher}.${doi?(' ' + doi):''}${url?(' ' + url):''}`;
}
if(values.type==='website'){
const access=values.accessDate?` Retrieved ${values.accessDate}, `:'';
return `${authors} (${year}). ${title}. ${values.siteName}.${access}${values.url}`;
}
return '';
}

document.getElementById('previewRef').addEventListener('click', ()=>{
const ref=generateAPA(gatherInputs());
document.getElementById('singlePreview').innerHTML=ref||'<span class="muted">Fill fields to preview.</span>';
});

document.getElementById('addRef').addEventListener('click', ()=>{
const data=gatherInputs();
const ref=generateAPA(data);
if(!ref){ alert('Please fill required fields'); return; }
refs.push({id:Date.now(), text:ref, data});
renderRefs(); updateOutput();
document.getElementById('singlePreview').textContent='Added to list.';
});

function renderRefs(){
refsContainer.innerHTML='';
if(refs.length===0){ refsContainer.innerHTML='<div class="muted">No references yet.</div>'; return; }
refs.forEach(r=>{
const div=document.createElement('div'); div.className='ref-item';
div.innerHTML=`<div>${r.text}</div>
<div style="display:flex; gap:6px">
<button class="btn btn-secondary" onclick="copyText('${r.id}')">Copy</button>
<button class="btn btn-secondary" onclick="editRef(${r.id})">Edit</button>
<button class="btn btn-secondary" onclick="deleteRef(${r.id})">Delete</button>
</div>`;
refsContainer.appendChild(div);
});
}

function updateOutput(){
const ol=document.getElementById('apaOutput');
ol.innerHTML='';
refs.forEach(r=>{ const li=document.createElement('li'); li.innerHTML=r.text; ol.appendChild(li); });
}

window.copyText=id=>{
const item=refs.find(r=>r.id==id);
if(item){ const text=item.text.replace(/<i>/g,'').replace(/<\/i>/g,''); navigator.clipboard.writeText(text).then(()=>alert('Copied')); }
}
window.editRef=id=>{
const item=refs.find(r=>r.id==id); if(!item) return;
const v=item.data; typeEl.value=v.type; typeEl.dispatchEvent(new Event('change'));
for(const key in v){ const el=document.getElementById(key); if(el) el.value=v[key]; }
refs=refs.filter(r=>r.id!==id); renderRefs(); updateOutput(); window.scrollTo({top:0,behavior:'smooth'});
}
window.deleteRef=id=>{ if(confirm('Delete this reference?')){ refs=refs.filter(r=>r.id!==id); renderRefs(); updateOutput(); } }

document.getElementById('copyAll').addEventListener('click', ()=>{
if(refs.length===0){ alert('No references'); return; }
const textAll=refs.map(r=>r.text.replace(/<i>/g,'').replace(/<\/i>/g,'')).join('\n\n');
navigator.clipboard.writeText(textAll).then(()=>alert('All copied'));
});

document.getElementById('downloadHtml').addEventListener('click', ()=>{
if(refs.length===0){ alert('No references'); return; }
const html=`<ol>${refs.map(r=>`<li>${r.text}</li>`).join('')}</ol>`;
const blob=new Blob([html],{type:'text/html'}); const url=URL.createObjectURL(blob);
const a=document.createElement('a'); a.href=url; a.download='references.html'; a.click(); URL.revokeObjectURL(url);
});

document.getElementById('clearFields').addEventListener('click', ()=>{
document.querySelectorAll('input, select, textarea').forEach(el=>{ if(el.id!=='type') el.value=''; });
document.getElementById('singlePreview').textContent='No preview yet.';
});
</script>
</body>
</html>

